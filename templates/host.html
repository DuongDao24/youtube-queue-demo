<!-- =========================================================
YouTube Queue Online ‚Äî v01.6.2a
Ng√†y c·∫≠p nh·∫≠t: 23/10/2025
Lo·∫°i c·∫≠p nh·∫≠t: + Chat realtime (Flask-SocketIO) cho trang Host
Thay ƒë·ªïi t·ªëi thi·ªÉu, gi·ªØ nguy√™n layout/thi·∫øt k·∫ø hi·ªán t·∫°i:
- Th√™m kh·ªëi UI Chat (neu-card) ·ªü cu·ªëi trang
- Th√™m script Socket.IO client v√† g·∫Øn window.IS_HOST = true
- KH√îNG thay ƒë·ªïi ph·∫ßn Control/Player/Queue/Settings/Logo/Password
========================================================= -->
<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>{{ app_title }} - Host</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/static/style.css">
  <script src="https://www.youtube.com/iframe_api"></script>
</head>
<body class="blurred">
  <!-- ===== HOST VERIFY POPUP ===== -->
  <div id="lockOverlay" class="fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50">
    <div class="neu-card section w-80 text-center p-6">
      <h2 class="text-xl font-bold mb-4">HOST VERIFY</h2>
      <input id="hostPass" type="password" placeholder="Enter password" class="neu-inset w-full px-3 py-2 mb-3 text-center">
      <button id="btnHostLogin" class="neu-btn neu-btn-primary w-full">Login</button>
      <div id="loginMsg" class="text-sm mt-2 text-red-500"></div>
    </div>
  </div>

  <div class="max-w-7xl mx-auto p-6 stack">
    <!-- Header -->
    <div class="flex items-center gap-4">
      {% if logo_url %}
      <div class="neu-pill p-2">
        <img src="{{ logo_url }}" class="h-8 w-8 rounded-md" alt="logo">
      </div>
      {% endif %}
      <h1 class="text-3xl font-bold">{{ app_title }} ‚Äî Host</h1>
    </div>

    <!-- Control bar -->
    <div class="neu-card section">
      <h2 class="font-semibold mb-3">‚öôÔ∏è YouTube Queue Control ‚Äî Options</h2>
      <div class="flex flex-wrap items-center gap-3">
        <button id="btnPrev" class="neu-btn">‚èÆ Prev</button>
        <button id="btnPlay" class="neu-btn neu-btn-primary">‚ñ∂ Start</button>
        <button id="btnNext" class="neu-btn">‚è≠ Next</button>
        <button id="btnClear" class="neu-btn">üóë Clear</button>
      </div>
      <div id="actionStatus" class="small mt-2"></div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Left: Player + Queue -->
      <div class="lg:col-span-2 stack">
        <!-- Player -->
        <div class="neu-card section">
          <h2 class="font-semibold mb-3">Now Playing</h2>
          <div class="relative">
            <div id="player" class="w-full aspect-video rounded-2xl overflow-hidden bg-black"></div>
            <div id="countdown" class="countdown-badge hidden">3</div>
          </div>
        </div>

        <!-- Queue -->
        <div class="neu-card section">
          <h2 class="font-semibold mb-3">Queue</h2>
          <div id="queue" class="list"></div>
        </div>
      </div>

      <!-- Right: Settings + History -->
      <div class="stack">
        <!-- System Settings -->
        <div class="neu-card section stack w-full max-w-full">
          <h2 class="font-semibold mb-3">System Settings</h2>

          <!-- Submit limit -->
          <div class="flex items-center justify-between gap-3">
            <label class="text-sm text-gray-600 whitespace-nowrap">Submit limit (seconds)</label>
            <input id="rate" type="number" min="10" step="10" class="neu-inset px-3 py-2 w-28 text-center">
          </div>

          <!-- Nickname limit -->
          <div class="flex items-center justify-between gap-3">
            <label class="text-sm text-gray-600 whitespace-nowrap">Nickname limit (minutes)</label>
            <input id="nickLimit" type="number" min="1" step="1" class="neu-inset px-3 py-2 w-28 text-center">
          </div>

          <!-- Save button -->
          <div class="pt-3">
            <button id="btnSaveCfg" class="neu-btn neu-btn-primary w-full">Save settings</button>
          </div>
        </div>

        <!-- Recent history -->
        <div class="neu-card section">
          <h2 class="font-semibold mb-3">Recent history</h2>
          <div id="history" class="list"></div>
        </div>
      </div>
    </div>

    <!-- Logo Settings -->
    <div class="neu-card section mt-6">
      <h2 class="font-semibold mb-3">Logo Settings</h2>
      <div class="stack">
        <label class="small">Logo (png/jpg/gif)</label>
        <input id="logo" type="file" accept=".png,.jpg,.jpeg,.gif" class="neu-btn-light w-full">
        <button id="btnLogo" class="neu-btn">Upload</button>
      </div>
    </div>

    <!-- Change Host Password -->
    <div class="neu-card section mt-6">
      <h2 class="font-semibold mb-3">Change Host Password</h2>
      <div class="stack gap-2">
        <input id="oldPass" type="password" class="neu-inset px-3 py-2" placeholder="Current password">
        <input id="newPass" type="password" class="neu-inset px-3 py-2" placeholder="New password">
        <input id="masterKey" type="password" class="neu-inset px-3 py-2" placeholder="HOST_KEY">
        <button id="btnChangePass" class="neu-btn neu-btn-primary w-full">Change Password</button>
      </div>
      <div id="changeMsg" class="small mt-2"></div>
    </div>

    <!-- =========================
         v01.6.2a ‚Äî Chat UI (Host)
         ========================= -->
    <div class="neu-card section mt-6">
      <h2 class="font-semibold mb-3">üí¨ Chat</h2>
      <div id="chat-box" class="neu-inset" style="height:250px; overflow-y:auto; padding:10px;"></div>
      <div class="stack" style="margin-top:10px;">
        <div style="display:flex; gap:8px;">
          <input id="chat-input" class="neu-inset" placeholder="G·ª≠i tin nh·∫Øn..." style="flex:1;">
          <button id="send-btn" class="btn btn-primary">G·ª≠i üí¨</button>
        </div>
      </div>
    </div>
    <!-- ===== end Chat UI ===== -->

  </div>

  <script>
    const HOST_KEY = "{{ host_key }}"; /* d√πng ng·∫ßm cho API control; kh√¥ng hi·ªÉn th·ªã cho user */
    // v01.6.2a ‚Äî ƒë√°nh d·∫•u l√† Host ƒë·ªÉ JS hi·ªÉn th·ªã tag [HOST]
    window.IS_HOST = true;
  </script>

  <!-- v01.6.2a ‚Äî Socket.IO client (realtime) -->
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js" integrity="sha384-Q96P8w4r4f1QpFthYvQ3VY6dH6s7Yx+JmJxL9k+ZCw1Yt+3y4t9nqz3l5lRj+3vM" crossorigin="anonymous"></script>
  
  <script src="/static/host.js"></script>
</body>
</html>
